<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>

<body>
    <header>
        <div class="top-header">
            <p>SATE: Sistema de Aplica√ß√£o de Testes Eletr√¥nicos</p>
        </div>

        <div class="middle-header">
            <img src="https://www.inoversasul.org/wp-content/uploads/2025/08/cebaspe1.png" alt="">
            <div class="middle-titles">
                <h3>Avalia√ß√£o de Desempenho de Estudante ANO - ETAPA</h3>
                <p>Nome do Aluno (CPF) | CARGO | <a href="">Sair</a></p>
            </div>
            <img src="https://logopng.com.br/logos/senai-165.png" alt="">
        </div>

        <div class="header-footer">
            <p>Desenvolvimento de Sistemas</p>
        </div>
    </header>

    <aside>
        <h4>Restam: H h M min</h4>
        <div class="resumo-prova">
            <p class="title">Resumo da Prova</p>
            <div class="respondidas">
                <div class="circle" id="answered-count">0</div>
                <p>Quest√µes respondidas</p>
            </div>

            <div class="nao-respondidas">
                <div class="circle" id="blank-count">0</div>
                <p>Quest√µes em branco</p>
            </div>
        </div>

        <div class="questoes-prova">
            <p>Quest√µes da prova</p>
            <!-- container din√¢mico das quest√µes -->
            <div class="questoes-example-container" id="quest-list"></div>

        </div>

        <div class="aside-footer">
            <button id="finishBtn">Finalizar prova</button>

            <img src="https://icones.pro/wp-content/uploads/2021/05/icone-point-d-interrogation-question-noir.png"
                alt="">
        </div>
    </aside>

    <main>
        <div class="quest">Quest√£o <span id="current-number">1</span> - Desenvolvimento de Sistemas</div>

        <div class="pergunta" id="question-text">
        </div>

        <div class="questions" id="options-container">
        </div>

        <div style="padding:12px; display:flex; gap:8px;">
            <button id="prevBtn">Anterior</button>
            <button id="nextBtn">Pr√≥xima</button>
            <button id="clearBtn">Apagar Resposta</button>
        </div>

    </main>
    <div id="resultModal" class="modal">
        <div class="modal-box">

            <div class="modal-header">
                <h2>Resultado da Avalia√ß√£o</h2>
                <button id="closeModal">‚úï</button>
            </div>

            <div class="result-grid">

                <div class="chart-area">
                    <canvas id="resultChart"></canvas>
                </div>

                <div class="stats-area">

                    <div class="stat-card success">
                        <h3 id="correctCount">0</h3>
                        <p>Acertos</p>
                    </div>

                    <div class="stat-card error">
                        <h3 id="wrongCount">0</h3>
                        <p>Erros</p>
                    </div>

                    <div class="stat-card percent">
                        <h3 id="percentCount">0%</h3>
                        <p>Aproveitamento</p>
                    </div>

                </div>

            </div>

        </div>
    </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>

        const questions = [
            {
                text: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. (Quest√£o 1)',
                correct: 1,
                options: [
                    'Alternativa A - resposta 1',
                    'Alternativa B - resposta 1',
                    'Alternativa C - resposta 1',
                    'Alternativa D - resposta 1',
                    'Alternativa E - resposta 1'
                ]
            },
            {
                text: 'Lorem ipsum dolor sit amet... (Quest√£o 2)',
                correct: 0,
                options: ['A2', 'B2', 'C2', 'D2', 'E2']
            },
            {
                text: 'Enunciado da quest√£o 3',
                correct: 2,
                options: ['A3', 'B3', 'C3', 'D3', 'E3']
            },
            {
                text: 'Enunciado da quest√£o 4',
                correct: 3,
                options: ['A4', 'B4', 'C4', 'D4', 'E4']
            },
            {
                text: 'Enunciado da quest√£o 5',
                correct: 1,
                options: ['A5', 'B5', 'C5', 'D5', 'E5']
            },
            {
                text: 'Enunciado da quest√£o 6',
                correct: 4,
                options: ['A6', 'B6', 'C6', 'D6', 'E6']
            }
        ];

        let currentIndex = 0;
        const answers = Array(questions.length).fill(null);
        const statuses = Array(questions.length).fill('unvisited');

        const qText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const currentNumber = document.getElementById('current-number');
        const questList = document.getElementById('quest-list');
        const answeredCountEl = document.getElementById('answered-count');
        const blankCountEl = document.getElementById('blank-count');
        document.getElementById('closeModal').addEventListener('click', () => {

            document.getElementById('resultModal').classList.remove('active');

        });


        function renderQuestion(i) {

            const q = questions[i];

            currentNumber.textContent = i + 1;
            qText.textContent = q.text;
            optionsContainer.innerHTML = '';

            q.options.forEach((opt, idx) => {

                const wrap = document.createElement('div');
                wrap.className = 'question-letter option';

                const circle = document.createElement('div');
                circle.className = 'question-circles';
                circle.textContent = String.fromCharCode(97 + idx);

                const p = document.createElement('p');
                p.innerHTML = opt;

                wrap.appendChild(circle);
                wrap.appendChild(p);

                wrap.addEventListener('click', () => {

                    answers[currentIndex] = idx;
                    statuses[currentIndex] = 'answered';

                    renderQuestion(currentIndex);
                    renderAside();
                    updateSummary();
                    updateClearButton();

                });

                if (answers[i] === idx) {
                    wrap.classList.add('selected');
                }

                optionsContainer.appendChild(wrap);

            });

            updateClearButton();
        }

        function renderAside() {

            questList.innerHTML = '';

            questions.forEach((_, idx) => {

                const btn = document.createElement('div');

                btn.className = 'circle-question-example question-button';
                btn.textContent = idx + 1;

                if (statuses[idx] === 'answered' || answers[idx] !== null) btn.classList.add('answered');
                if (statuses[idx] === 'skipped' && answers[idx] === null) btn.classList.add('skipped');
                if (idx === currentIndex) btn.classList.add('current');

                btn.addEventListener('click', () => {

                    currentIndex = idx;
                    renderQuestion(currentIndex);
                    renderAside();

                });

                questList.appendChild(btn);

            });
        }

        function updateSummary() {

            const answered = statuses.filter(s => s === 'answered').length;
            const blank = answers.filter(a => a === null).length;

            answeredCountEl.textContent = answered;
            blankCountEl.textContent = blank;
        }

        function updateClearButton() {

            const clearBtn = document.getElementById('clearBtn');

            clearBtn.style.display = answers[currentIndex] !== null
                ? 'inline-block'
                : 'none';

        }

        document.getElementById('nextBtn').addEventListener('click', () => {

            if (answers[currentIndex] === null) {
                statuses[currentIndex] = 'skipped';
            } else {
                statuses[currentIndex] = 'answered';
            }

            if (currentIndex < questions.length - 1) currentIndex++;

            renderQuestion(currentIndex);
            renderAside();
            updateSummary();

        });

        document.getElementById('prevBtn').addEventListener('click', () => {

            if (currentIndex > 0) currentIndex--;

            renderQuestion(currentIndex);
            renderAside();

        });

        document.getElementById('clearBtn').addEventListener('click', () => {

            answers[currentIndex] = null;
            statuses[currentIndex] = 'unvisited';

            renderQuestion(currentIndex);
            renderAside();
            updateSummary();

        });


        // üî• FINALIZAR PROVA COM MODAL + GR√ÅFICO
        document.getElementById('finishBtn').addEventListener('click', () => {

            let correct = 0;
            let wrong = 0;

            questions.forEach((q, i) => {

                if (answers[i] === null) return;

                if (answers[i] === q.correct) {
                    correct++;
                } else {
                    wrong++;
                }

            });

            const blank = questions.length - (correct + wrong);
            const percent = Math.round((correct / questions.length) * 100);

            document.getElementById('correctCount').textContent = correct;
            document.getElementById('wrongCount').textContent = wrong;
            document.getElementById('percentCount').textContent = percent + '%';

            document.getElementById('resultModal').classList.add('active');

            createChart(correct, wrong, blank);

        });

        let myChart = null;

        function createChart(correct, wrong, blank) {

            const ctx = document.getElementById('resultChart').getContext('2d');

            // Se j√° existir gr√°fico, destr√≥i
            if (myChart) {
                myChart.destroy();
            }

            Chart.defaults.font.family = "'Segoe UI', 'Helvetica', 'Arial', sans-serif";

            myChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Acertos', 'Erros', 'Em branco'],
                    datasets: [{
                        data: [correct, wrong, blank],
                        backgroundColor: [
                            '#28a745',
                            '#dc3545',
                            '#e2e8f0'
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '75%'
                }
            });
        }



        // estilos dinamicos
        const style = document.createElement('style');

        style.innerHTML = `
.option{cursor:pointer;padding:8px;}
.option.selected{background:#fff2d1;border-radius:6px;}
.option.selected .question-circles{background:black;color:white;}
.question-button{cursor:pointer;width:30px;height:30px;display:inline-flex;justify-content:center;align-items:center;margin:4px;border-radius:50%;border:1px solid rgb(35,49,177);}
.question-button.answered{background:black;color:white;border-color:black;}
.question-button.skipped{background:red;color:white;border-color:red;}
.question-button.current{background:rgb(35,49,177);color:#fff;border-color:rgb(35,49,177);box-shadow:0 0 0 3px rgba(35,49,177,0.12);}
`;

        document.head.appendChild(style);

        renderQuestion(currentIndex);
        renderAside();
        updateSummary();

    </script>



</body>

</html>